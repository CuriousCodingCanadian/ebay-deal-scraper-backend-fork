<!DOCTYPE html>
<html>
<head>
  <title>eBay Search</title>
</head>
<body>
  <h1>eBay Search</h1>
  <input type="text" id="searchInput" placeholder="Enter your search query">
  <button id="searchButton">Search</button>
  <div id="results"></div>

  <script>
    const searchInput = document.getElementById('searchInput');
    const searchButton = document.getElementById('searchButton');
    const resultsDiv = document.getElementById('results');

    searchButton.addEventListener('click', async () => {
      const query = searchInput.value;

      try {
        const response = await fetch(`/api/search?q=${query}`); // Make the API call
        const listings = await response.json();

        resultsDiv.innerHTML = ''; // Clear previous results

        if (listings.length === 0) {
          resultsDiv.innerHTML = '<p>No listings found.</p>';
          return;
        }

        listings.forEach(listing => {
          const listingDiv = document.createElement('div');
          listingDiv.innerHTML = `
            <h2>${listing.title}</h2>
            <a href="${listing.itemWebUrl}" target="_blank">View on eBay</a><br>
            Price: ${listing.price.value} ${listing.price.currency}<br>
            <hr>
          `;
          resultsDiv.appendChild(listingDiv);
        });

      } catch (error) {
        console.error('Error fetching from server:', error);
        resultsDiv.innerHTML = '<p>Error fetching listings.</p>';
      }
    });
  </script>
</body>
</html>